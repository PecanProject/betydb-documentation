<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.12.1 and GitBook 2.6.7" />

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modifying-the-betydb-schema.html">
<link rel="next" href="release-notes-template.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="part"><span><b>I Overview</b></span></li>
<li class="chapter" data-level="1" data-path="about-betydb-database-description-and-users-guide.html"><a href="about-betydb-database-description-and-users-guide.html"><i class="fa fa-check"></i><b>1</b> About BETYdb: Database Description and User’s Guide</a><ul>
<li class="chapter" data-level="1.1" data-path="about-betydb-database-description-and-users-guide.html"><a href="about-betydb-database-description-and-users-guide.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="about-betydb-database-description-and-users-guide.html"><a href="about-betydb-database-description-and-users-guide.html#scope"><i class="fa fa-check"></i><b>1.2</b> Scope</a></li>
<li class="chapter" data-level="1.3" data-path="about-betydb-database-description-and-users-guide.html"><a href="about-betydb-database-description-and-users-guide.html#content"><i class="fa fa-check"></i><b>1.3</b> Content</a></li>
<li class="chapter" data-level="1.4" data-path="about-betydb-database-description-and-users-guide.html"><a href="about-betydb-database-description-and-users-guide.html#design"><i class="fa fa-check"></i><b>1.4</b> Design</a></li>
<li class="chapter" data-level="1.5" data-path="about-betydb-database-description-and-users-guide.html"><a href="about-betydb-database-description-and-users-guide.html#data-entry"><i class="fa fa-check"></i><b>1.5</b> Data Entry</a></li>
<li class="chapter" data-level="1.6" data-path="about-betydb-database-description-and-users-guide.html"><a href="about-betydb-database-description-and-users-guide.html#software"><i class="fa fa-check"></i><b>1.6</b> Software</a></li>
<li class="chapter" data-level="1.7" data-path="about-betydb-database-description-and-users-guide.html"><a href="about-betydb-database-description-and-users-guide.html#list-of-tables-in-the-bety-database"><i class="fa fa-check"></i><b>1.7</b> List of Tables in the BETY Database</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="betydb-tables.html"><a href="betydb-tables.html"><i class="fa fa-check"></i><b>2</b> BETYdb Tables</a><ul>
<li class="chapter" data-level="2.1" data-path="betydb-tables.html"><a href="betydb-tables.html#schema-enhanced-entity-relationship-model"><i class="fa fa-check"></i><b>2.1</b> Schema: Enhanced Entity-Relationship Model</a></li>
<li class="chapter" data-level="2.2" data-path="betydb-tables.html"><a href="betydb-tables.html#tables"><i class="fa fa-check"></i><b>2.2</b> Tables</a></li>
<li class="chapter" data-level="2.3" data-path="betydb-tables.html"><a href="betydb-tables.html#table-and-field-naming-conventions"><i class="fa fa-check"></i><b>2.3</b> Table and field naming conventions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="betydb-tables.html"><a href="betydb-tables.html#data-tables"><i class="fa fa-check"></i><b>2.3.1</b> Data Tables</a></li>
<li class="chapter" data-level="2.3.2" data-path="betydb-tables.html"><a href="betydb-tables.html#auxillary-tables"><i class="fa fa-check"></i><b>2.3.2</b> Auxillary Tables</a></li>
<li class="chapter" data-level="2.3.3" data-path="betydb-tables.html"><a href="betydb-tables.html#join-tables"><i class="fa fa-check"></i><b>2.3.3</b> Join Tables</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Installing BETYdb</b></span></li>
<li class="chapter" data-level="3" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html"><i class="fa fa-check"></i><b>3</b> Deploying a Production Copy of the BETYdb Web Application</a><ul>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#installing-and-configuring-ruby-and-rails-code"><i class="fa fa-check"></i>Installing and Configuring Ruby and Rails Code</a><ul>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-1-log-in-to-the-deployment-machine-as-an-administrator"><i class="fa fa-check"></i>Step 1: Log in to the deployment machine as an administrator</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-2-add-a-new-user-as-the-owner-of-the-betydb-instance"><i class="fa fa-check"></i>Step 2: Add a new user as the owner of the BETYdb instance</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-3-choose-a-location-for-the-application-code"><i class="fa fa-check"></i>Step 3: Choose a location for the application code</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-4-create-the-target-parent-directory-and-clone-the-betydb-code-from-the-github-repository"><i class="fa fa-check"></i>Step 4: Create the target parent directory and clone the BETYdb code from the GitHub repository:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-5-if-you-have-not-already-done-so-install-the-correct-version-of-ruby"><i class="fa fa-check"></i>Step 5: If you have not already done so, install the correct version of Ruby</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-6-log-in-to-the-applications-user-account-and-make-sure-you-are-in-the-rails-root-directory"><i class="fa fa-check"></i>Step 6: Log in to the application’s user account and make sure you are in the Rails root directory:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-7-use-the-bundler-to-install-the-application-gems"><i class="fa fa-check"></i>Step 7: Use the Bundler to install the application Gems:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-8-create-a-database-configuration-file"><i class="fa fa-check"></i>Step 8: Create a database configuration file</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-9-create-a-rails-application-customization-file"><i class="fa fa-check"></i>Step 9: Create a Rails application customization file</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-10-compile-rails-assets"><i class="fa fa-check"></i>Step 10: Compile Rails assets:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#loading-the-betydb-database"><i class="fa fa-check"></i>Loading the BETYdb Database</a><ul>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-11-download-the-load.bety.sh-script-from-the-pecan-repository"><i class="fa fa-check"></i>Step 11: Download the load.bety.sh script from the PEcAn repository:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-12-if-you-arent-already-there-cd-to-the-application-root-directory"><i class="fa fa-check"></i>Step 12: If you aren’t already there, cd to the application root directory:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-13-log-in-as-user-postgres"><i class="fa fa-check"></i>Step 13: Log in as user postgres:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-14-create-a-role-and-a-database-for-the-betydb-app"><i class="fa fa-check"></i>Step 14: Create a role and a database for the BETYdb app</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-15-run-the-load.bety.sh-script"><i class="fa fa-check"></i>Step 15: Run the load.bety.sh script:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-16-optional-load-data-from-another-machine"><i class="fa fa-check"></i>Step 16: (Optional) Load data from another machine:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-17-exit-the-postgres-user-account"><i class="fa fa-check"></i>Step 17: Exit the postgres user account:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#complete-apache-and-passenger-configuration"><i class="fa fa-check"></i>Complete Apache and Passenger configuration</a><ul>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-18-check-that-the-correct-version-of-ruby-is-enabled"><i class="fa fa-check"></i>Step 18: Check that the correct version of Ruby is enabled:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-19-find-the-path-to-the-ruby-interpreter"><i class="fa fa-check"></i>Step 19: Find the path to the Ruby interpreter:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-20-configure-the-apache-server"><i class="fa fa-check"></i>Step 20: Configure the Apache Server</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-21-restart-apache"><i class="fa fa-check"></i>Step 21: Restart Apache:</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-22-test"><i class="fa fa-check"></i>Step 22: Test:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#final-steps"><i class="fa fa-check"></i>Final Steps</a><ul>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-23-create-a-betydb-administrative-account"><i class="fa fa-check"></i>Step 23: Create a BETYdb administrative account</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-24-re-set-the-guest-user-account-password"><i class="fa fa-check"></i>Step 24: Re-Set the Guest user account password</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-25-ensure-images-for-priors-pages-are-generated"><i class="fa fa-check"></i>Step 25: Ensure images for Priors pages are generated</a></li>
<li class="chapter" data-level="" data-path="deploying-a-production-copy-of-the-betydb-web-application.html"><a href="deploying-a-production-copy-of-the-betydb-web-application.html#step-26-ensure-the-schemaspy-documentation-can-be-generated"><i class="fa fa-check"></i>Step 26: Ensure the SchemaSpy documentation can be generated</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="setting-up-a-centos-server.html"><a href="setting-up-a-centos-server.html"><i class="fa fa-check"></i><b>4</b> Setting Up a CentOS Server</a><ul>
<li class="chapter" data-level="4.1" data-path="setting-up-a-centos-server.html"><a href="setting-up-a-centos-server.html#install-centos-7"><i class="fa fa-check"></i><b>4.1</b> Install CentOS 7</a></li>
<li class="chapter" data-level="4.2" data-path="setting-up-a-centos-server.html"><a href="setting-up-a-centos-server.html#install-additional-system-software"><i class="fa fa-check"></i><b>4.2</b> Install additional system software</a></li>
<li class="chapter" data-level="4.3" data-path="setting-up-a-centos-server.html"><a href="setting-up-a-centos-server.html#install-required-ruby-and-rails-softwareruby_with_rvm"><i class="fa fa-check"></i><b>4.3</b> Install required Ruby and Rails software</a><ul>
<li class="chapter" data-level="4.3.1" data-path="setting-up-a-centos-server.html"><a href="setting-up-a-centos-server.html#rvm-ruby-version-manager"><i class="fa fa-check"></i><b>4.3.1</b> RVM (Ruby Version Manager)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="setting-up-a-centos-server.html"><a href="setting-up-a-centos-server.html#bundler"><i class="fa fa-check"></i><b>4.4</b> Bundler:</a></li>
<li class="chapter" data-level="4.5" data-path="setting-up-a-centos-server.html"><a href="setting-up-a-centos-server.html#node.js-needed-to-be-able-to-compile-rails-assets"><i class="fa fa-check"></i><b>4.5</b> node.js (needed to be able to compile Rails assets):</a></li>
<li class="chapter" data-level="4.6" data-path="setting-up-a-centos-server.html"><a href="setting-up-a-centos-server.html#phusion-passengerphusion_passenger"><i class="fa fa-check"></i><b>4.6</b> Phusion Passenger</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="configuring-postgresql.html"><a href="configuring-postgresql.html"><i class="fa fa-check"></i><b>5</b> Configuring PostgreSQL</a><ul>
<li class="chapter" data-level="5.1" data-path="configuring-postgresql.html"><a href="configuring-postgresql.html#step-1-initialize-the-database-cluster-and-start-the-server"><i class="fa fa-check"></i><b>5.1</b> Step 1: Initialize the database cluster and start the server</a></li>
<li class="chapter" data-level="5.2" data-path="configuring-postgresql.html"><a href="configuring-postgresql.html#step-2-enable-password-authentication-for-all-users-other-than-postgres"><i class="fa fa-check"></i><b>5.2</b> Step 2: Enable password authentication for all users other than postgres</a></li>
<li class="chapter" data-level="5.3" data-path="configuring-postgresql.html"><a href="configuring-postgresql.html#step-3-create-a-new-role-and-new-database-for-betydb"><i class="fa fa-check"></i><b>5.3</b> Step 3: Create a new role and new database for BETYdb</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html"><i class="fa fa-check"></i><b>6</b> Archived Setup Documentation</a><ul>
<li class="chapter" data-level="6.1" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#setting-up-a-redhat-or-centos-server"><i class="fa fa-check"></i><b>6.1</b> Setting up a RedHat or CentOS Server</a><ul>
<li class="chapter" data-level="6.1.1" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#overview"><i class="fa fa-check"></i><b>6.1.1</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#instructions-for-installing-and-configuring-postgresql"><i class="fa fa-check"></i><b>6.2</b> Instructions for Installing and Configuring PostgreSQL</a></li>
<li class="chapter" data-level="6.3" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#installing-the-betydb-rails-application"><i class="fa fa-check"></i><b>6.3</b> Installing the BETYdb Rails Application</a><ul>
<li class="chapter" data-level="6.3.1" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#prerequisites"><i class="fa fa-check"></i><b>6.3.1</b> Prerequisites</a></li>
<li class="chapter" data-level="6.3.2" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#installing-the-rails-application"><i class="fa fa-check"></i><b>6.3.2</b> Installing the Rails Application</a></li>
<li class="chapter" data-level="6.3.3" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#updating-syncing-the-database"><i class="fa fa-check"></i><b>6.3.3</b> Updating / Syncing the database</a></li>
<li class="chapter" data-level="6.3.4" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#starting-the-betydb-rails-web-application"><i class="fa fa-check"></i><b>6.3.4</b> Starting the BETYdb Rails Web Application</a></li>
<li class="chapter" data-level="6.3.5" data-path="archived-setup-documentation.html"><a href="archived-setup-documentation.html#logrotation"><i class="fa fa-check"></i><b>6.3.5</b> Logrotation</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III BETYdb System Administration</b></span></li>
<li class="chapter" data-level="7" data-path="updating-betydb-when-new-versions-are-released.html"><a href="updating-betydb-when-new-versions-are-released.html"><i class="fa fa-check"></i><b>7</b> Updating BETYdb When New Versions are Released</a><ul>
<li class="chapter" data-level="7.1" data-path="updating-betydb-when-new-versions-are-released.html"><a href="updating-betydb-when-new-versions-are-released.html#updating-the-bety-database"><i class="fa fa-check"></i><b>7.1</b> Updating the BETY database</a></li>
<li class="chapter" data-level="7.2" data-path="updating-betydb-when-new-versions-are-released.html"><a href="updating-betydb-when-new-versions-are-released.html#update-the-rails-app-and-schema"><i class="fa fa-check"></i><b>7.2</b> Update the Rails app and schema</a></li>
<li class="chapter" data-level="7.3" data-path="updating-betydb-when-new-versions-are-released.html"><a href="updating-betydb-when-new-versions-are-released.html#load-a-fresh-version-of-database"><i class="fa fa-check"></i><b>7.3</b> Load a fresh version of database</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="distributed-instances-of-betydb.html"><a href="distributed-instances-of-betydb.html"><i class="fa fa-check"></i><b>8</b> Distributed instances of BETYdb</a><ul>
<li class="chapter" data-level="8.1" data-path="distributed-instances-of-betydb.html"><a href="distributed-instances-of-betydb.html#syncing-databases"><i class="fa fa-check"></i><b>8.1</b> Syncing Databases</a><ul>
<li class="chapter" data-level="8.1.1" data-path="distributed-instances-of-betydb.html"><a href="distributed-instances-of-betydb.html#exporting-data"><i class="fa fa-check"></i><b>8.1.1</b> Exporting Data</a></li>
<li class="chapter" data-level="8.1.2" data-path="distributed-instances-of-betydb.html"><a href="distributed-instances-of-betydb.html#importing-data"><i class="fa fa-check"></i><b>8.1.2</b> Importing Data</a></li>
<li class="chapter" data-level="8.1.3" data-path="distributed-instances-of-betydb.html"><a href="distributed-instances-of-betydb.html#primary-key-allocations"><i class="fa fa-check"></i><b>8.1.3</b> Primary Key Allocations</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="distributed-instances-of-betydb.html"><a href="distributed-instances-of-betydb.html#feedback-tab"><i class="fa fa-check"></i><b>8.2</b> Feedback Tab</a></li>
<li class="chapter" data-level="8.3" data-path="distributed-instances-of-betydb.html"><a href="distributed-instances-of-betydb.html#customization"><i class="fa fa-check"></i><b>8.3</b> Customization</a></li>
<li class="chapter" data-level="8.4" data-path="distributed-instances-of-betydb.html"><a href="distributed-instances-of-betydb.html#issues"><i class="fa fa-check"></i><b>8.4</b> Issues</a></li>
</ul></li>
<li class="part"><span><b>IV BETYdb Development</b></span></li>
<li class="chapter" data-level="9" data-path="ruby-on-rails-application-overview-draft.html"><a href="ruby-on-rails-application-overview-draft.html"><i class="fa fa-check"></i><b>9</b> Ruby on Rails Application Overview (draft)</a><ul>
<li class="chapter" data-level="9.1" data-path="ruby-on-rails-application-overview-draft.html"><a href="ruby-on-rails-application-overview-draft.html#introduction-to-ruby-on-rails"><i class="fa fa-check"></i><b>9.1</b> Introduction to Ruby-on-Rails</a></li>
<li class="chapter" data-level="9.2" data-path="ruby-on-rails-application-overview-draft.html"><a href="ruby-on-rails-application-overview-draft.html#introduction-to-mvc"><i class="fa fa-check"></i><b>9.2</b> Introduction to MVC</a></li>
<li class="chapter" data-level="9.3" data-path="ruby-on-rails-application-overview-draft.html"><a href="ruby-on-rails-application-overview-draft.html#source-code-map"><i class="fa fa-check"></i><b>9.3</b> Source Code Map</a></li>
<li class="chapter" data-level="9.4" data-path="ruby-on-rails-application-overview-draft.html"><a href="ruby-on-rails-application-overview-draft.html#misc.-information"><i class="fa fa-check"></i><b>9.4</b> Misc. Information</a><ul>
<li class="chapter" data-level="9.4.1" data-path="ruby-on-rails-application-overview-draft.html"><a href="ruby-on-rails-application-overview-draft.html#providing-model-output-for-download"><i class="fa fa-check"></i><b>9.4.1</b> Providing model output for download</a></li>
<li class="chapter" data-level="9.4.2" data-path="ruby-on-rails-application-overview-draft.html"><a href="ruby-on-rails-application-overview-draft.html#related-issues-commits"><i class="fa fa-check"></i><b>9.4.2</b> Related Issues / Commits:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html"><i class="fa fa-check"></i><b>10</b> Ruby-on-Rails: Developing, Upgrading, and Deploying</a><ul>
<li class="chapter" data-level="10.1" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html#development-and-testing"><i class="fa fa-check"></i><b>10.1</b> Development and Testing</a></li>
<li class="chapter" data-level="10.2" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html#deploying-a-new-version"><i class="fa fa-check"></i><b>10.2</b> Deploying a new version:</a></li>
<li class="chapter" data-level="10.3" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html#deploying-or-upgrading-to-a-new-version-of-the-betydb-rails-app"><i class="fa fa-check"></i><b>10.3</b> Deploying or upgrading to a new version of the BETYdb Rails app</a><ul>
<li class="chapter" data-level="10.3.1" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html#running-migrations"><i class="fa fa-check"></i><b>10.3.1</b> Running Migrations</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html#versioning-and-tagging"><i class="fa fa-check"></i><b>10.4</b> Versioning and Tagging</a><ul>
<li class="chapter" data-level="10.4.1" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html#protocol-for-defining-and-releasing-versions"><i class="fa fa-check"></i><b>10.4.1</b> Protocol for defining and releasing versions</a></li>
<li class="chapter" data-level="10.4.2" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html#version-numbering"><i class="fa fa-check"></i><b>10.4.2</b> Version Numbering</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="ruby-on-rails-developing-upgrading-and-deploying.html"><a href="ruby-on-rails-developing-upgrading-and-deploying.html#commenting-in-the-rails-models"><i class="fa fa-check"></i><b>10.5</b> Commenting in the Rails Models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="automated-tests.html"><a href="automated-tests.html"><i class="fa fa-check"></i><b>11</b> Automated Tests</a><ul>
<li class="chapter" data-level="11.1" data-path="automated-tests.html"><a href="automated-tests.html#development-and-testing-1"><i class="fa fa-check"></i><b>11.1</b> Development and Testing</a></li>
<li class="chapter" data-level="11.2" data-path="automated-tests.html"><a href="automated-tests.html#running-the-rspec-tests-on-betydb."><i class="fa fa-check"></i><b>11.2</b> Running the RSpec tests on BETYdb.</a><ul>
<li class="chapter" data-level="11.2.1" data-path="automated-tests.html"><a href="automated-tests.html#preparing-the-test-database."><i class="fa fa-check"></i><b>11.2.1</b> Preparing the test database.</a></li>
<li class="chapter" data-level="11.2.2" data-path="automated-tests.html"><a href="automated-tests.html#running-the-tests"><i class="fa fa-check"></i><b>11.2.2</b> Running the tests</a></li>
<li class="chapter" data-level="11.2.3" data-path="automated-tests.html"><a href="automated-tests.html#troubleshooting"><i class="fa fa-check"></i><b>11.2.3</b> Troubleshooting</a></li>
<li class="chapter" data-level="11.2.4" data-path="automated-tests.html"><a href="automated-tests.html#creating-a-new-postgis-enabled-database-template"><i class="fa fa-check"></i><b>11.2.4</b> Creating a new PostGIS-enabled database template</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-style.html"><a href="code-style.html"><i class="fa fa-check"></i><b>12</b> Code Style</a><ul>
<li class="chapter" data-level="12.1" data-path="code-style.html"><a href="code-style.html#whitespace-conventions-in-the-betydb-code"><i class="fa fa-check"></i><b>12.1</b> Whitespace conventions in the BETYdb Code</a></li>
<li class="chapter" data-level="12.2" data-path="code-style.html"><a href="code-style.html#fixing-legacy-formatting"><i class="fa fa-check"></i><b>12.2</b> Fixing legacy formatting</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="complex-joins-in-the-web-interface.html"><a href="complex-joins-in-the-web-interface.html"><i class="fa fa-check"></i><b>13</b> Complex Joins in the Web Interface</a></li>
<li class="chapter" data-level="14" data-path="database-constraints.html"><a href="database-constraints.html"><i class="fa fa-check"></i><b>14</b> Database Constraints</a><ul>
<li class="chapter" data-level="14.1" data-path="database-constraints.html"><a href="database-constraints.html#types-of-constraints"><i class="fa fa-check"></i><b>14.1</b> Types of Constraints</a></li>
<li class="chapter" data-level="14.2" data-path="database-constraints.html"><a href="database-constraints.html#value-constraints-including-some-not-null-constraints"><i class="fa fa-check"></i><b>14.2</b> Value Constraints (including some NOT NULL constraints)</a><ul>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#global"><i class="fa fa-check"></i>Global</a></li>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#covariates-1"><i class="fa fa-check"></i>covariates:</a></li>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#managements-1"><i class="fa fa-check"></i>managements:</a></li>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#species"><i class="fa fa-check"></i>species:</a></li>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#sites-1"><i class="fa fa-check"></i>sites:</a></li>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#traits-1"><i class="fa fa-check"></i>traits:</a></li>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#treatments-1"><i class="fa fa-check"></i>treatments:</a></li>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#users"><i class="fa fa-check"></i>users:</a></li>
<li class="chapter" data-level="" data-path="database-constraints.html"><a href="database-constraints.html#yields-see-also-traits-constraints"><i class="fa fa-check"></i>yields: [see also traits constraints]</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="database-constraints.html"><a href="database-constraints.html#foreign-key-constraints"><i class="fa fa-check"></i><b>14.3</b> Foreign Key Constraints</a></li>
<li class="chapter" data-level="14.4" data-path="database-constraints.html"><a href="database-constraints.html#non-null-constraints"><i class="fa fa-check"></i><b>14.4</b> Non Null Constraints</a></li>
<li class="chapter" data-level="14.5" data-path="database-constraints.html"><a href="database-constraints.html#uniqueness-constraints"><i class="fa fa-check"></i><b>14.5</b> Uniqueness constraints</a></li>
<li class="chapter" data-level="14.6" data-path="database-constraints.html"><a href="database-constraints.html#technical-note"><i class="fa fa-check"></i><b>14.6</b> Technical Note</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="modifying-the-betydb-schema.html"><a href="modifying-the-betydb-schema.html"><i class="fa fa-check"></i><b>15</b> Modifying the BETYdb schema</a><ul>
<li class="chapter" data-level="15.1" data-path="modifying-the-betydb-schema.html"><a href="modifying-the-betydb-schema.html#modifying-bety-troubleshooting"><i class="fa fa-check"></i><b>15.1</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="issuing-a-new-release.html"><a href="issuing-a-new-release.html"><i class="fa fa-check"></i><b>16</b> Issuing a New Release</a><ul>
<li class="chapter" data-level="16.1" data-path="issuing-a-new-release.html"><a href="issuing-a-new-release.html#writing-release-notes"><i class="fa fa-check"></i><b>16.1</b> Writing release notes</a></li>
<li class="chapter" data-level="16.2" data-path="issuing-a-new-release.html"><a href="issuing-a-new-release.html#upgrading-the-canonical-betydb-rails-sitecanonical_site"><i class="fa fa-check"></i><b>16.2</b> Upgrading the canonical BETYdb Rails site</a></li>
<li class="chapter" data-level="16.3" data-path="issuing-a-new-release.html"><a href="issuing-a-new-release.html#upgrading-other-production-sites"><i class="fa fa-check"></i><b>16.3</b> Upgrading other production sites</a></li>
<li class="chapter" data-level="16.4" data-path="issuing-a-new-release.html"><a href="issuing-a-new-release.html#finishing-the-release"><i class="fa fa-check"></i><b>16.4</b> Finishing the release</a><ul>
<li class="chapter" data-level="16.4.1" data-path="issuing-a-new-release.html"><a href="issuing-a-new-release.html#version-numbering-1"><i class="fa fa-check"></i><b>16.4.1</b> Version Numbering</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Appendix</b></span></li>
<li class="chapter" data-level="" data-path="release-notes-template.html"><a href="release-notes-template.html"><i class="fa fa-check"></i>Release Notes Template</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="issuing-a-new-release" class="section level1">
<h1><span class="header-section-number">16</span> Issuing a New Release</h1>
<p>From time to time, or whenever an important and needed code change is made, the principle maintainer of the BETYdb Rails application should issue a new release and upgrade all of the sites under his or her purview.<a href="#fn11" class="footnoteRef" id="fnref11"><sup>11</sup></a> In what follows, we delineate the key steps in this process.</p>
<div id="writing-release-notes" class="section level2">
<h2><span class="header-section-number">16.1</span> Writing release notes</h2>
<p>Begin a new release by visiting the Web page <a href="https://github.com/PecanProject/bety/releases" class="uri" target="_blank">https://github.com/PecanProject/bety/releases</a> and clicking the <em>Draft a new release</em> button. The begin writing release notes in the large textarea box.</p>
<p>The release notes should begin with a one-line summary of the release, written as a level-one heading (that is, with one “#” mark flush left). Follow this with a paragraph describing the release in slightly greater detail.</p>
<p>Subsequent sections should summarize new features, bug fixes, and give some instruction to site maintainers on doing an upgrade to the new release.</p>
<p>An easy way to begin writing release notes is to use an earlier version’s release notes (perhaps the notes from the previous one) as a template. Just click on the <em>Releases</em> link, click the <em>Edit</em> button of the release you choose to be you model, copy the text from the description section to the clipboard, and paste it into the description section for the release you are creating. Then change the text of each section as appropriate.</p>
<p>To remind oneself of what changes to the code have been made since the previous release, you can examine the Git log content starting with the previous release using (for example) the command</p>
<pre><code>git log betydb_x.xx..master --stat</code></pre>
<p>(Here, <code>betydb_x.xx</code> is assumed to be the tag name for the previous release. The <code>--stat</code> flag is used to include a list of each file that was changed in each update.)</p>
<p>Once the release notes are written, it remains only to fill in the release title and tag name text boxes and click the <em>Publish Release</em> button. But these final steps should be delayed until at least the primary site, <a href="https://www.betydb.org" class="uri" target="_blank">https://www.betydb.org</a>, has been upgraded, especially if the release involves a database migration. We give more details about this below. <strong>For now, just click the <em>Save draft</em> button to ensure your release notes don’t disappear.</strong></p>
</div>
<div id="upgrading-the-canonical-betydb-rails-sitecanonical_site" class="section level2">
<h2><span class="header-section-number">16.2</span> Upgrading the canonical BETYdb Rails site<a href="#fn12" class="footnoteRef" id="fnref12"><sup>12</sup></a></h2>
<blockquote>
<p><strong>Note:</strong> Although these instructions are specific to the primary production site, <a href="https://www.betydb.org" class="uri" target="_blank">https://www.betydb.org</a>, upgrading the beta site before upgrading the production site is <strong><em>highly recommended</em></strong>. If there are serious problems with the pending release version, it is much easier if they are found while upgrading a test version of the site so as not to have to try to back out of an upgrade to the production site. Moreover, upgrading the beta site can serve as a trial run for upgrading the production site.</p>
<p>Note the following modification of the steps below when upgrading the beta site:</p>
<ul>
<li><p>After logging in to <code>ebi-forecast</code>, <code>cd</code> to <code>/usr/local/beta</code> rather than <code>/usr/local/ebi</code>.</p></li>
<li><p>Making a backup copy of the database is unnecessary.</p></li>
<li><p><strong>Important</strong> If a migration is done, <em>do not</em> commit the updated <code>structure.sql</code> to the Git repository. It is the structure of the canonical copy of the database—ebi_production—that we want to document. While it is likely that the structure of the beta site’s database and the structure of the production site’s database are identical, it is best not to rely on this.</p></li>
</ul>
</blockquote>
<p>Here are the steps required to upgrade the primary BETYdb Rails site to a newly-released version.<a href="#fn13" class="footnoteRef" id="fnref13"><sup>13</sup></a> These step are roughly the same for <em>all</em> the sites to be upgraded, but there are some slight differences, which we shall make note of where appropriate.</p>
<ol style="list-style-type: decimal">
<li><p>Log in to the host machine ebi-forecast.igb.illinois.edu:</p>
<pre><code>ssh -X ebi-forecast.igb.illinois.edu</code></pre>
<p>The <code>-X</code> flag is needed if you intend to run the JavaScript-based RSpec tests on the host site (highly recommended).</p></li>
<li><p>Go to the Rails root directory for the EBI site:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">cd</span> /usr/local/ebi</code></pre></div></li>
<li><p>Check the git status to be sure the copy is “clean”:</p>
<pre><code>git status</code></pre>
<p>Generally there shouldn’t be any modified files and you should be on the master branch.<a href="#fn14" class="footnoteRef" id="fnref14"><sup>14</sup></a></p></li>
<li><p>Get the latest code from Github:</p>
<pre><code>git pull</code></pre>
<p>In rare cases, it may be that you need to release and deploy a version of the code other than the head of the master branch. This should be avoided if at all possible, especially if the release contains one or more migrations: it complicates incorporating an up-to-date version of the <code>structure.sql</code> into the release. Note that we tag releases AFTER deploying them, so we can’t use the release tag as the git reference.</p>
<pre><code>git checkout &lt;git reference to version being deployed&gt;</code></pre></li>
<li><p>Check the gem bundle and install new Gems if needed:</p>
<pre><code>bundle check</code></pre>
<p>If the the bundle contains uninstalled Gems, run this:</p>
<pre><code>bundle install</code></pre></li>
<li><p>Check for pending migrations and if needed, migrate the database:</p>
<pre><code>bundle exec rake db:migrate:status RAILS_ENV=production </code></pre>
<p>If there are no pending migrations, skip to the testing step.</p></li>
<li><p>Make a backup copy of the database:</p>
<p><code>pg_dump ebi_production &gt; [some suitable directory]/ebi_production.psql</code> Generally, after the dump file has been created, I rename it to include the timestamp information in the file name: ebi_production_YYYYMMDDhhmm.psql. This way multiple dump files can be stored in the same directory.)</p></li>
<li><p>Perform the pending migrations:</p>
<p><code>bundle exec rake db:migrate RAILS_ENV=production</code></p>
<p><strong>It is especially important to dump the database if any of the pending migrations will delete data!</strong></p></li>
<li><p>Generate an up-to-date copy of <code>db/structure.sql</code><a href="#fn15" class="footnoteRef" id="fnref15"><sup>15</sup></a> and check it in:<a href="#fn16" class="footnoteRef" id="fnref16"><sup>16</sup></a></p>
<pre><code>bundle exec rake db:structure:dump RAILS_ENV=production
git add db/structure.sql
git commit
git push</code></pre></li>
<li><p>Run automated tests:</p>
<pre><code>bundle exec rake db:test:prepare
bundle exec rake db:fixtures:load RAILS_ENV=test
bundle exec rspec -t ~js
bundle exec rspec -t js</code></pre>
<p>The two rspec lines can be combined (just <code>rspec</code>), but I generally like to run the tests that don’t require a JavaScript driver first. They are much faster. <em>Note that running the tests that do require a JavaScript driver need an X server to be running.</em> In other words, use the <code>-X</code> option when ssh-ing into the production server. For more information about automated tests, see <a href="automated-tests.html#automated-tests">Automated Tests</a>.</p></li>
<li><p>If the tests pass, restart the Rails server:</p>
<pre><code>touch tmp/restart.txt</code></pre></li>
<li><p>Visit the updated site in a browser.</p>
<p>This is to ensure the site is up and running. You may also wish to check some of the changes the upgrade is meant to implement to make sure they are working as expected.</p></li>
</ol>
</div>
<div id="upgrading-other-production-sites" class="section level2">
<h2><span class="header-section-number">16.3</span> Upgrading other production sites</h2>
<p>The steps for upgrading other production sites is largely the same as for the primary site <a href="https://www.betydb.org" class="uri" target="_blank">https://www.betydb.org</a>.</p>
<p>[To do: add details]</p>
</div>
<div id="finishing-the-release" class="section level2">
<h2><span class="header-section-number">16.4</span> Finishing the release</h2>
<p>Now that the release has been deployed, you can finish the formal release on GitHub. Go to the releases list at <a href="https://github.com/PecanProject/bety/releases" class="uri" target="_blank">https://github.com/PecanProject/bety/releases</a> and click on the draft that you started earlier. Give the release a title of the form “BETYdb X.XX” or “BETYdb X.XX.XX” and a Tag version identifier of the form “betydb_X.XX” (or “betydb_X.XX.XX”) and click the <em>Publish release</em> button. (See <a href="ruby-on-rails-developing-upgrading-and-deploying.html#version-numbering">Version Numbering</a> below.)</p>
<p>I usually announce a new release on the Gitter chat page for BETYdb at <a href="https://gitter.im/PecanProject/bety?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" class="uri" target="_blank">https://gitter.im/PecanProject/bety?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge</a>. Include a link to the release notes in your announcement.</p>
<div id="version-numbering-1" class="section level3">
<h3><span class="header-section-number">16.4.1</span> Version Numbering</h3>
<p>We loosely follow <a href="http://semver.org/" target="_blank">semantic versioning</a>.</p>
<ul>
<li>Any tag of the form betydb_x.x or betydb_x.x.x refers to a version that has been tested and deployed.</li>
<li>Changes in the first or second digit of the version number mark some significant change. For example, the change to major version number 2.x marks the change to a new user interface.</li>
</ul>

</div>
</div>
</div>



<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>As of this writing these include deployments at <a href="https://www.betydb.org/" class="uri" target="_blank">https://www.betydb.org/</a>, <a href="https://terra-mepp.illinois.edu/bety" class="uri" target="_blank">https://terra-mepp.illinois.edu/bety</a>, <a href="https://terraref.ncsa.illinois.edu/bety/" class="uri" target="_blank">https://terraref.ncsa.illinois.edu/bety/</a>, and <a href="https://terraref.ncsa.illinois.edu/bety-test/" class="uri" target="_blank">https://terraref.ncsa.illinois.edu/bety-test/</a>. <a href="https://www.betydb.org/" class="uri" target="_blank">https://www.betydb.org/</a> is considered the canonical copy.<a href="issuing-a-new-release.html#fnref11">↩</a></p></li>
<li id="fn12"><p>As of this writing, the primary or canonical site is the one on ebi-forecast.igb.illinois.edu at the URL <a href="https://www.betydb.org/" class="uri" target="_blank">https://www.betydb.org/</a>. We call it canonical both because it was first, because it is site 0 in the site numbering scheme, but mainly because it is the site we use when generating updates to the structure.sql file, which itself is considered the canonical definition of the BETYdb database schema.<a href="issuing-a-new-release.html#fnref12">↩</a></p></li>
<li id="fn13"><p>By <em>newly released version</em>, we actually mean the version that is <em>about</em> to be released, because as noted, we recommend not releasing a new version until at least the primary site has been upgraded.<a href="issuing-a-new-release.html#fnref13">↩</a></p></li>
<li id="fn14"><p>In general, there <em>will</em> be some <em>untracked</em> files. The untracked files that <em>should</em> be present—database.yml for example—should be mentioned in a .gitignore file so that they don’t show up in the <code>git status</code> output. But the .gitignore files are not (at the time of this writing) up to date. Moreover, there may on occasion be intentionally modified files—for example, if an urgent fix was needed for a particular site before a bona fide release was possible. In these cases, it is best to save a copy of the modified file, revert the original, do the Git update, and then check if any changes from the saved copy need to be merged in. (Delete the copy when you are done with it.) In many cases, the custom changes will match the changes in the release.<a href="issuing-a-new-release.html#fnref14">↩</a></p></li>
<li id="fn15"><p>Note that we no longer use the <code>schema.rb</code> file (see <a href="https://github.com/PecanProject/bety/issues/44" class="uri" target="_blank">https://github.com/PecanProject/bety/issues/44</a>). The <code>structure.sql</code> files allow for complete documentation of the database structure, including features that (by default) are not expressible in the <code>schema.rb</code> file. <em><code>structure.sql</code> is the canonical specification of the complete database schema, the schema which the Rails code is meant to be run against.</em><a href="issuing-a-new-release.html#fnref15">↩</a></p></li>
<li id="fn16"><p>In point of fact, performing a migration of the production database <em>should</em> automatically generate an up-to-date version of <code>db/structure.sql</code>, so the first line in this sequence is not strictly necessary.<a href="issuing-a-new-release.html#fnref16">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modifying-the-betydb-schema.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="release-notes-template.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
